<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Sasha AI - True Intelligence</title>
    <style>
        :root { --neon: #00d8ff; --dark: #050505; }
        body, html { margin: 0; padding: 0; background: var(--dark); color: #fff; font-family: 'Segoe UI', sans-serif; height: 100%; overflow: hidden; }

        .top-nav { position: fixed; top: 25px; left: 25px; z-index: 1001; display: flex; gap: 15px; }
        .cyber-btn { 
            padding: 12px 25px; border: 1px solid var(--neon); background: rgba(0,0,0,0.8); 
            color: var(--neon); cursor: pointer; font-weight: bold; border-radius: 2px;
            text-transform: uppercase; transition: 0.3s;
        }
        .cyber-btn:hover { background: var(--neon); color: #000; box-shadow: 0 0 20px var(--neon); }

        #sasha-viewport { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }

        #chat-container { 
            position: fixed; bottom: 30px; left: 30px; width: 420px; height: 480px; 
            background: rgba(10,10,10,0.9); border: 1px solid #222; border-radius: 10px;
            z-index: 1001; display: flex; flex-direction: column; backdrop-filter: blur(15px);
        }
        #messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
        .msg { padding: 12px; border-radius: 8px; font-size: 14px; line-height: 1.5; max-width: 85%; }
        .ai { background: rgba(0, 216, 255, 0.1); color: var(--neon); align-self: flex-start; border-left: 4px solid var(--neon); }
        .user { background: #222; align-self: flex-end; border: 1px solid #444; }

        .input-row { padding: 15px; display: flex; gap: 10px; border-top: 1px solid #333; }
        input { flex: 1; background: #000; border: 1px solid #444; color: #fff; padding: 12px; border-radius: 5px; outline: none; }
        input:focus { border-color: var(--neon); }
    </style>
</head>
<body>

    <div class="top-nav">
        <button class="cyber-btn" onclick="register()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        <button class="cyber-btn" id="login" disabled>–í—Ö–æ–¥</button>
    </div>

    <div id="sasha-viewport"></div>

    <div id="chat-container">
        <div id="messages">
            <div class="msg ai"><b>–°–ò–°–¢–ï–ú–ê:</b> –°–∞—à–∞ –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è. –ö–ª–∏–∫–Ω–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.</div>
        </div>
        <div class="input-row">
            <input type="text" id="user-in" placeholder="–ù–∞–ø–∏—à–∏ –°–∞—à–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ)..." onkeypress="if(event.key==='Enter') askSasha()">
            <button class="cyber-btn" onclick="askSasha()">SEND</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
let sasha, isSpeaking = false, lastResponse = "";
let clock = new THREE.Clock();

/* ================== –ú–û–ó–ì –°–ê–®–ò (GPT-LITE v2) ================== */
const SashaBrain = {
    memory: JSON.parse(localStorage.getItem('sasha_knowledge')) || {
        facts: {},   // –ö–õ–Æ–ß ‚Üí –ó–ù–ê–ß–ï–ù–ò–ï
        dialog: [],
        userName: ""
    },

    save() {
        localStorage.setItem('sasha_knowledge', JSON.stringify(this.memory));
    },

    detectIntent(text) {
        text = text.toLowerCase();
        if (text.startsWith("–∑–∞–ø–æ–º–Ω–∏")) return "learn";
        if (text.includes("–∫—Ç–æ —Ç—ã") || text.includes("–æ —Å–µ–±–µ")) return "identity";
        if (text.includes("–ø—Ä–∏–≤–µ—Ç") || text.includes("–∑–¥—Ä–∞–≤—Å—Ç–≤")) return "greeting";
        if (text.startsWith("—á—Ç–æ —Ç–∞–∫–æ–µ") || text.startsWith("–∫—Ç–æ —Ç–∞–∫–æ–π")) return "definition";
        if (text.includes("?")) return "question";
        if (text.length < 4) return "unclear";
        return "chat";
    },

    learn(text) {
        // —Ñ–æ—Ä–º–∞—Ç: JARVIS ‚Äî —ç—Ç–æ ....
        const match = text.match(/(.+?)\s*‚Äî\s*—ç—Ç–æ\s*(.+)/i);
        if (!match) return "–§–æ—Ä–º–∞—Ç –æ–±—É—á–µ–Ω–∏—è: ¬´–∑–∞–ø–æ–º–Ω–∏ X ‚Äî —ç—Ç–æ Y¬ª";

        const key = match[1].trim().toLowerCase();
        const value = match[2].trim();

        this.memory.facts[key] = value;
        this.save();

        return `–ü—Ä–∏–Ω—è—Ç–æ. –Ø –∑–∞–ø–æ–º–Ω–∏–ª: ${key.toUpperCase()} ‚Äî —ç—Ç–æ ${value}`;
    },

    answerDefinition(text) {
        const key = text
            .replace(/—á—Ç–æ —Ç–∞–∫–æ–µ|–∫—Ç–æ —Ç–∞–∫–æ–π|\?/gi, "")
            .trim()
            .toLowerCase();

        if (this.memory.facts[key]) {
            return `${key.toUpperCase()} ‚Äî —ç—Ç–æ ${this.memory.facts[key]}`;
        }

        return "–Ø –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞—é. –°–∫–∞–∂–∏: ¬´–∑–∞–ø–æ–º–Ω–∏ ‚Ä¶ ‚Äî —ç—Ç–æ ‚Ä¶¬ª";
    },

    process(text) {
        const intent = this.detectIntent(text);
        this.memory.dialog.push(text);
        if (this.memory.dialog.length > 10) this.memory.dialog.shift();
        this.save();

        if (intent === "greeting")
            return "–ü—Ä–∏–≤–µ—Ç. –Ø –Ω–∞ —Å–≤—è–∑–∏. –ß–µ–º –∑–∞–π–º—ë–º—Å—è?";

        if (intent === "identity")
            return "–Ø ‚Äî –°–∞—à–∞. –õ–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç AlexanderDev. –Ø –æ–±—É—á–∞—é—Å—å, –∑–∞–ø–æ–º–∏–Ω–∞—é –∏ –æ—Ç–≤–µ—á–∞—é –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ.";

        if (intent === "learn") {
            const data = text.replace(/–∑–∞–ø–æ–º–Ω–∏/i, "").trim();
            return data ? this.learn(data) : "–°–∫–∞–∂–∏, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å.";
        }

        if (intent === "definition")
            return this.answerDefinition(text);

        if (intent === "unclear")
            return "–£—Ç–æ—á–Ω–∏ –º—ã—Å–ª—å. –Ø —Ö–æ—á—É –ø–æ–Ω—è—Ç—å —Ç–µ–±—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.";

        return "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∞–π.";
    }
};

/* ================== –ì–û–õ–û–° ================== */
function speak(text) {
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.pitch = 0.9;
    u.rate = 1;
    u.onstart = () => isSpeaking = true;
    u.onend = () => isSpeaking = false;
    window.speechSynthesis.speak(u);
}

/* ================== –ß–ê–¢ ================== */
function askSasha() {
    const input = document.getElementById('user-in');
    const val = input.value.trim();
    if (!val) return;

    addMsg("–í—ã", val, "user");
    input.value = "";

    setTimeout(() => {
        const res = SashaBrain.process(val);
        lastResponse = res;
        addMsg("–°–∞—à–∞", res, "ai");
        speak(res);
    }, 300);
}

function addMsg(author, text, type) {
    const box = document.getElementById('messages');
    box.innerHTML += `<div class="msg ${type}"><b>${author}:</b> ${text}</div>`;
    box.scrollTop = box.scrollHeight;
}

function welcome() {
    if (window.started) return;
    window.started = true;
    const msg = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞. –Ø –≥–æ—Ç–æ–≤ –∫ –æ–±—É—á–µ–Ω–∏—é –∏ –¥–∏–∞–ª–æ–≥—É.";
    addMsg("–°–∞—à–∞", msg, "ai");
    speak(msg);
}

window.addEventListener("click", welcome);

/* ================== 3D ================== */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
renderer.setSize(innerWidth, innerHeight);
document.getElementById("sasha-viewport").appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff, 2.5));
camera.position.z = 5;

new THREE.GLTFLoader().load(
    "https://raw.githubusercontent.com/aproyt4-lang/GameDevAlex/main/SashaAI.glb",
    gltf => {
        sasha = gltf.scene;
        sasha.position.y = -1.2;
        sasha.scale.set(1.8, 1.8, 1.8);
        scene.add(sasha);
        animate();
    }
);

function animate() {
    requestAnimationFrame(animate);
    const t = clock.getElapsedTime();

    if (sasha) {
        sasha.position.y = -1.2 + Math.sin(t * 1.5) * 0.02;
        sasha.scale.y += ((isSpeaking ? 1.95 : 1.8) - sasha.scale.y) * 0.2;
        sasha.lookAt(camera.position); // üî• –°–ú–û–¢–†–ò–¢ –ù–ê –¢–ï–ë–Ø
    }

    renderer.render(scene, camera);
}
</script>
</body>
</html>














