<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Sasha AI</title>

<style>
:root { --neon:#00d8ff; --dark:#050505; }
html,body{
  margin:0;padding:0;
  background:var(--dark);
  color:#fff;
  font-family:Segoe UI;
  height:100%;
  overflow:hidden
}

#sasha-viewport{
  position:fixed;
  inset:0;
  z-index:1;
  pointer-events:none
}

#chat-container{
  position:fixed;
  bottom:30px;
  left:30px;
  width:420px;
  height:480px;
  background:rgba(10,10,10,.9);
  border-radius:10px;
  border:1px solid var(--neon);
  display:flex;
  flex-direction:column;
  z-index:10
}

#messages{
  flex:1;
  padding:15px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:10px
}

.msg{
  padding:10px;
  border-radius:6px;
  max-width:85%;
  font-size:14px;
  white-space:pre-wrap
}

.ai{
  background:rgba(0,216,255,.1);
  color:var(--neon);
  align-self:flex-start
}

.user{
  background:#222;
  align-self:flex-end
}

.input-row{
  display:flex;
  gap:8px;
  padding:10px;
  border-top:1px solid #333
}

input{
  flex:1;
  background:#000;
  border:1px solid #444;
  color:#fff;
  padding:10px;
  border-radius:5px
}

button{
  background:#000;
  border:1px solid var(--neon);
  color:var(--neon);
  padding:10px 18px;
  cursor:pointer
}
</style>
</head>

<body>

<div id="sasha-viewport"></div>

<div id="chat-container">
  <div id="messages">
    <div class="msg ai"><b>–°–ò–°–¢–ï–ú–ê:</b> –ö–ª–∏–∫–Ω–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</div>
  </div>
  <div class="input-row">
    <input id="user-in" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
      onkeydown="if(event.key==='Enter')askSasha()">
    <button onclick="askSasha()">SEND</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/GLTFLoader.js"></script>

<script>
let sasha,isSpeaking=false,activated=false;
const clock=new THREE.Clock();

/* ===== –ú–û–ó–ì (–ù–ê–°–¢–û–Ø–©–ï–ï –û–ë–£–ß–ï–ù–ò–ï) ===== */
const SashaBrain={
  memory: JSON.parse(localStorage.getItem("sasha_memory")) || {
    knowledge: [],
    mode: "normal"
  },

  save(){
    localStorage.setItem("sasha_memory", JSON.stringify(this.memory));
  },

  extractTags(text){
    return text
      .toLowerCase()
      .replace(/[^a-z–∞-—è0-9+#]/gi," ")
      .split(/\s+/)
      .filter(w=>w.length>2);
  },

  process(input){
    const text=input.trim();

    /* –ê–ö–¢–ò–í–ê–¶–ò–Ø –û–ë–£–ß–ï–ù–ò–Ø */
    if(/^–∑–∞–ø–æ–º–Ω–∏$/i.test(text)){
      this.memory.mode="learning";
      this.save();
      return "–û–∫. –û—Ç–ø—Ä–∞–≤—å –∫–æ–¥ –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é ‚Äî —è —Å–æ—Ö—Ä–∞–Ω—é.";
    }

    /* –°–û–•–†–ê–ù–ï–ù–ò–ï –ó–ù–ê–ù–ò–Ø */
    if(this.memory.mode==="learning"){
      this.memory.knowledge.push({
        id:Date.now(),
        text,
        tags:this.extractTags(text),
        date:new Date().toISOString()
      });
      this.memory.mode="normal";
      this.save();
      return "–ó–∞–ø–æ–º–Ω–∏–ª. –ú–æ–≥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É.";
    }

    /* –ó–ê–ü–†–û–° –î–ê–ù–ù–´–• */
    if(/^(–¥–∞–π|–ø–æ–∫–∞–∂–∏|–≤—ã–≤–µ–¥–∏)/i.test(text)){
      const q=this.extractTags(text);
      const res=this.memory.knowledge.filter(k =>
        q.some(t=>k.tags.includes(t))
      );
      if(!res.length)
        return "–£ –º–µ–Ω—è –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –∑–Ω–∞–Ω–∏—è. –û–±—É—á–∏ –º–µ–Ω—è.";
      return res.map((k,i)=>`üìå ${i+1}:\n${k.text}`).join("\n\n");
    }

    /* –ü–ê–ú–Ø–¢–¨ */
    if(/—á—Ç–æ —Ç—ã –∑–Ω–∞–µ—à—å|–ø–∞–º—è—Ç—å/i.test(text)){
      return `–í –ø–∞–º—è—Ç–∏ ${this.memory.knowledge.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤.`;
    }

    return "–ì–æ—Ç–æ–≤ –æ–±—É—á–∞—Ç—å—Å—è –∏–ª–∏ –≤—ã–¥–∞–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è.";
  }
};

/* ===== –ì–û–õ–û–° ===== */
function speak(text){
  speechSynthesis.cancel();
  const u=new SpeechSynthesisUtterance(text);
  u.rate=1;
  u.pitch=.9;
  speechSynthesis.speak(u);
}

/* ===== –ß–ê–¢ ===== */
function addMsg(w,t,c){
  messages.innerHTML+=`<div class="msg ${c}"><b>${w}:</b> ${t}</div>`;
  messages.scrollTop=messages.scrollHeight;
}

function askSasha(){
  const i=document.getElementById("user-in");
  if(!i.value.trim())return;
  addMsg("–í—ã",i.value,"user");
  const r=SashaBrain.process(i.value);
  setTimeout(()=>{addMsg("–°–∞—à–∞",r,"ai");speak(r)},150);
  i.value="";
}

/* ===== –ê–ö–¢–ò–í–ê–¶–ò–Ø ===== */
document.body.addEventListener("click",()=>{
  if(activated)return;
  activated=true;
  const hi="–ü—Ä–∏–≤–µ—Ç. –Ø –°–∞—à–∞. –ì–æ—Ç–æ–≤ –∫ –æ–±—É—á–µ–Ω–∏—é.";
  addMsg("–°–∞—à–∞",hi,"ai");
  speak(hi);
},{once:true});

/* ===== 3D ===== */
const scene=new THREE.Scene();
const cam=new THREE.PerspectiveCamera(45,innerWidth/innerHeight,.1,1000);
cam.position.z=5;

const r=new THREE.WebGLRenderer({alpha:true,antialias:true});
r.setSize(innerWidth,innerHeight);
document.getElementById("sasha-viewport").appendChild(r.domElement);

scene.add(new THREE.AmbientLight(0xffffff,2.5));

new THREE.GLTFLoader().load(
  "https://raw.githubusercontent.com/aproyt4-lang/GameDevAlex/main/SashaAI.glb",
  g=>{
    sasha=g.scene;
    sasha.position.y=-1.2;
    sasha.scale.set(1.8,1.8,1.8);
    sasha.rotation.set(0,Math.PI,0);
    scene.add(sasha);
    animate();
  }
);

function animate(){
  requestAnimationFrame(animate);
  const t=clock.getElapsedTime();
  if(sasha){
    sasha.position.y=-1.2+Math.sin(t*1.5)*.02;
    sasha.lookAt(cam.position);
  }
  r.render(scene,cam);
}
</script>
</body>
</html>


















